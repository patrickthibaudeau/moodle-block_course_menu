{"version":3,"file":"menu_builder.min.js","sources":["../src/menu_builder.js"],"sourcesContent":["import $ from 'jquery';\nimport jqui from 'jqueryui';\nimport ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport {get_string as getString} from 'core/str';\n\nexport const init = () => {\n    $('button').on('click', function (e) {\n        e.preventDefault();\n    });\n\n    $('.sections').sortable({\n        cancel: '',\n        cursor: 'move',\n        opacity: 0.4,\n        placeholder: \"sections-state-highlight\",\n\n        stop: function (event, ui) {\n            // Get list order\n            var itemOrder = $(this).sortable(\"toArray\");\n            // Loop through list\n            for (var i = 0; i < itemOrder.length; i++) {\n                console.log(i + \")\" + itemOrder[i]);\n                // Update order for each section\n                let updateSortOrder = ajax.call([{\n                    methodname: 'block_course_menu_update_section_sort_order',\n                    args: {\n                        id: itemOrder[i],\n                        sort_order: i\n                    }\n                }]);\n                updateSortOrder[0].done(function () {\n                    // Nothing to do here\n                });\n            }\n        }\n    });\n\n    $('.grid-list').sortable({\n        cancel: '',\n        cursor: 'move',\n        opacity: 0.4,\n        placeholder: \"buttons-state-highlight\",\n\n        stop: function (event, ui) {\n            // Get list order\n            var itemOrder = $(this).sortable(\"toArray\");\n            // Loop through list\n            for (var i = 0; i < itemOrder.length; i++) {\n                console.log(i + \")\" + itemOrder[i]);\n                // Update button sort order\n                let updateSortOrder = ajax.call([{\n                    methodname: 'block_course_menu_update_button_sort_order',\n                    args: {\n                        id: itemOrder[i],\n                        sort_order: i\n                    }\n                }]);\n                updateSortOrder[0].done(function () {\n                    // Nothing to do here\n                });\n            }\n        }\n    });\n\n    // Delete button\n    $('.delete-item').on('click', function () {\n        let id = $(this).data('id');\n\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: getString('delete_button', 'block_course_menu'),\n            body: getString('delete_button_help', 'block_course_menu')\n        }).then(function (modal) {\n\n            modal.setSaveButtonText(getString('yes', 'block_course_menu'));\n\n            modal.getRoot().on(ModalEvents.save, function () {\n                var deleteButton = ajax.call([{\n                    methodname: 'block_course_menu_delete_button',\n                    args: {\n                        id: id\n                    }\n                }]);\n\n                deleteButton[0].done(function (response) {\n                    return location.reload();\n                }).fail(function (ex) {\n                    alert('An error has occurred. The record was not saved');\n                });\n            });\n\n            console.log(ModalEvents);\n            modal.getRoot().on(ModalEvents.cancel, function () {\n                // CLose modal\n            });\n\n            /**\n             * Open the modal and run some jQuery\n             * for the campusLanguages so that select2 works\n             */\n            modal.show();\n        });\n    });\n\n    // Delete section\n    $('.delete-section').on('click', function () {\n        let coursemenuid = $(this).data('coursemenuid');\n        let sortorder = $(this).data('sectionorder');\n\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: getString('delete_section', 'block_course_menu'),\n            body: getString('delete_section_help', 'block_course_menu')\n        }).then(function (modal) {\n\n            modal.setSaveButtonText(getString('yes', 'block_course_menu'));\n\n            modal.getRoot().on(ModalEvents.save, function () {\n                var deleteSection = ajax.call([{\n                    methodname: 'block_course_menu_delete_section',\n                    args: {\n                        coursemenuid: coursemenuid,\n                        sortorder: sortorder\n                    }\n                }]);\n\n                deleteSection[0].done(function (response) {\n                    return location.reload();\n                }).fail(function (ex) {\n                    alert('An error has occurred. The record was not saved');\n                });\n            });\n\n            modal.getRoot().on(ModalEvents.cancel, function () {\n                // Close Modal\n            });\n\n            /**\n             * Open the modal and run some jQuery\n             * for the campusLanguages so that select2 works\n             */\n            modal.show();\n        });\n\n\n    });\n};"],"names":["on","e","preventDefault","sortable","cancel","cursor","opacity","placeholder","stop","event","ui","itemOrder","this","i","length","console","log","ajax","call","methodname","args","id","sort_order","done","data","create","type","ModalFactory","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","getRoot","ModalEvents","save","response","location","reload","fail","ex","alert","show","coursemenuid","sortorder"],"mappings":"qmBAOoB,yBACd,UAAUA,GAAG,SAAS,SAAUC,GAC9BA,EAAEC,wCAGJ,aAAaC,SAAS,CACpBC,OAAQ,GACRC,OAAQ,OACRC,QAAS,GACTC,YAAa,2BAEbC,KAAM,SAAUC,MAAOC,YAEfC,WAAY,mBAAEC,MAAMT,SAAS,WAExBU,EAAI,EAAGA,EAAIF,UAAUG,OAAQD,IAAK,CACvCE,QAAQC,IAAIH,EAAI,IAAMF,UAAUE,IAEVI,cAAKC,KAAK,CAAC,CAC7BC,WAAY,8CACZC,KAAM,CACFC,GAAIV,UAAUE,GACdS,WAAYT,MAGJ,GAAGU,MAAK,uCAOlC,cAAcpB,SAAS,CACrBC,OAAQ,GACRC,OAAQ,OACRC,QAAS,GACTC,YAAa,0BAEbC,KAAM,SAAUC,MAAOC,YAEfC,WAAY,mBAAEC,MAAMT,SAAS,WAExBU,EAAI,EAAGA,EAAIF,UAAUG,OAAQD,IAAK,CACvCE,QAAQC,IAAIH,EAAI,IAAMF,UAAUE,IAEVI,cAAKC,KAAK,CAAC,CAC7BC,WAAY,6CACZC,KAAM,CACFC,GAAIV,UAAUE,GACdS,WAAYT,MAGJ,GAAGU,MAAK,uCAQlC,gBAAgBvB,GAAG,SAAS,eACtBqB,IAAK,mBAAET,MAAMY,KAAK,6BAETC,OAAO,CAChBC,KAAMC,uBAAaC,MAAMC,YACzBC,OAAO,mBAAU,gBAAiB,qBAClCC,MAAM,mBAAU,qBAAsB,uBACvCC,MAAK,SAAUC,OAEdA,MAAMC,mBAAkB,mBAAU,MAAO,sBAEzCD,MAAME,UAAUnC,GAAGoC,sBAAYC,MAAM,WACdpB,cAAKC,KAAK,CAAC,CAC1BC,WAAY,kCACZC,KAAM,CACFC,GAAIA,OAIC,GAAGE,MAAK,SAAUe,iBACpBC,SAASC,YACjBC,MAAK,SAAUC,IACdC,MAAM,yDAId5B,QAAQC,IAAIoB,uBACZH,MAAME,UAAUnC,GAAGoC,sBAAYhC,QAAQ,eAQvC6B,MAAMW,iCAKZ,mBAAmB5C,GAAG,SAAS,eACzB6C,cAAe,mBAAEjC,MAAMY,KAAK,gBAC5BsB,WAAY,mBAAElC,MAAMY,KAAK,uCAEhBC,OAAO,CAChBC,KAAMC,uBAAaC,MAAMC,YACzBC,OAAO,mBAAU,iBAAkB,qBACnCC,MAAM,mBAAU,sBAAuB,uBACxCC,MAAK,SAAUC,OAEdA,MAAMC,mBAAkB,mBAAU,MAAO,sBAEzCD,MAAME,UAAUnC,GAAGoC,sBAAYC,MAAM,WACbpB,cAAKC,KAAK,CAAC,CAC3BC,WAAY,mCACZC,KAAM,CACFyB,aAAcA,aACdC,UAAWA,cAIL,GAAGvB,MAAK,SAAUe,iBACrBC,SAASC,YACjBC,MAAK,SAAUC,IACdC,MAAM,yDAIdV,MAAME,UAAUnC,GAAGoC,sBAAYhC,QAAQ,eAQvC6B,MAAMW"}